<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>من فرع → إلى فرع</title>
  <style>
    :root{--bg:#fff;--line:#e5e7eb;--btn:#111;--btnText:#fff;}
    *{box-sizing:border-box}
    body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:#111;}
    header{padding:1rem;text-align:center;font-size:1.25rem;font-weight:bold;border-bottom:1px solid var(--line);}
    .flex{display:flex;gap:0.5rem;padding:1rem;}
    select{flex:1;padding:0.5rem;border:1px solid var(--line);border-radius:6px;}
    .container{display:flex;gap:1rem;padding:1rem;}
    .box{flex:1;border:1px solid var(--line);border-radius:8px;padding:1rem;min-height:320px;overflow:auto;}
    .product{display:flex;align-items:center;justify-content:space-between;padding:0.5rem 0;border-bottom:1px solid var(--line);}
    .product img{width:48px;height:48px;object-fit:cover;border-radius:6px;margin-left:0.5rem;}
    .actions{padding:1rem;text-align:center;}
    button{background:var(--btn);color:var(--btnText);border:none;padding:0.6rem 1.2rem;border-radius:6px;cursor:pointer;font-size:1rem;}
    input.qty{width:50px;text-align:center;}
  </style>
</head>
<body>

<header>من فرع → إلى فرع</header>

<div class="flex">
  <select id="fromBranch">
    <option value="" disabled selected>اختر الفرع (من)</option>
    <option>Al-Ghanamiah Warehouse</option>
    <option>Al-Kharj Warehouse</option>
    <option>Dirajti Al-Narjis</option>
    <option>Dirajti Al-Khobar</option>
    <option>Dirajti Jeddah</option>
    <option>Dirajti Al-Sahafah</option>
    <option>Dirajti Al-Sulaimaniyah</option>
    <option>Dirajti Al-Masar Al-Riyadi</option>
    <option>Hajeen Al-Malaz</option>
    <option>Hajeen Al-Ruwabi</option>
    <option>Hajeen Al-Madinah</option>
    <option>Hajeen Hail</option>
  </select>
  <select id="toBranch">
    <option value="" disabled selected>اختر الفرع (إلى)</option>
    <option>Al-Ghanamiah Warehouse</option>
    <option>Al-Kharj Warehouse</option>
    <option>Dirajti Al-Narjis</option>
    <option>Dirajti Al-Khobar</option>
    <option>Dirajti Jeddah</option>
    <option>Dirajti Al-Sahafah</option>
    <option>Dirajti Al-Sulaimaniyah</option>
    <option>Dirajti Al-Masar Al-Riyadi</option>
    <option>Hajeen Al-Malaz</option>
    <option>Hajeen Al-Ruwabi</option>
    <option>Hajeen Al-Madinah</option>
    <option>Hajeen Hail</option>
  </select>
</div>

<div class="container">
  <div class="box" id="productList">
    <strong>المنتجات</strong>
  </div>
  <div class="box" id="cartList">
    <strong>السلة</strong>
  </div>
</div>

<div class="actions">
  <button onclick="submitOrder()">إرسال إلى Zapier</button>
</div>

<script>
  const webhookURL = "https://hooks.zapier.com/hooks/catch/20490421/utyod6s/";

  const PRODUCTS = [
    {sku:"'10572", name:"Electric Drift Scooter for Kids", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/s-l1200_b00e229d-a582-4808-b6a6-0ac455ede905.jpg?v=1744290455"},
    {sku:"'11695", name:"Bicycle - AMELIA", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/amelia--1.webp?v=1744290452"},
    {sku:"'10327", name:"Wall Scooter Holder", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/f7ad195dd8fe4a20e227e2ada8c4564b.png?v=1744290447"},
    {sku:"'10001", name:"Mountain Bike - Falcon 29\"", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/mountain-bike.jpg?v=1744290401"},
    {sku:"'10002", name:"City Bike - Urban Rider", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/city-bike.jpg?v=1744290402"},
    {sku:"'10003", name:"Folding Bike - Compact X", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/folding-bike.jpg?v=1744290403"},
    {sku:"'10004", name:"Helmet - Pro Safety", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/helmet.jpg?v=1744290404"},
    {sku:"'10005", name:"Cycling Gloves", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/gloves.jpg?v=1744290405"},
    {sku:"'10006", name:"Scooter Dido F70", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/dido-f70.jpg?v=1744290406"},
    {sku:"'10007", name:"Kids Bicycle - Bella 16\"", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/kids-bike.jpg?v=1744290407"},
    {sku:"'10008", name:"Electric Bike V8", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/ebike-v8.jpg?v=1744290408"},
    {sku:"'10009", name:"BMX Bike - Stunt Pro", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/bmx.jpg?v=1744290409"},
    {sku:"'10010", name:"Rear Light LED", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/rear-light.jpg?v=1744290410"},
    {sku:"'10011", name:"Front Light LED", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/front-light.jpg?v=1744290411"},
    {sku:"'10012", name:"Air Pump - Portable", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/pump.jpg?v=1744290412"},
    {sku:"'10013", name:"Lock - Anti Theft", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/lock.jpg?v=1744290413"},
    {sku:"'10014", name:"Cycling Bottle", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/bottle.jpg?v=1744290414"},
    {sku:"'10015", name:"Cycling Shoes", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/shoes.jpg?v=1744290415"},
    {sku:"'10016", name:"E-Scooter Charger", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/charger.jpg?v=1744290416"},
    {sku:"'10017", name:"Basket - Front", image:"https://cdn.shopify.com/s/files/1/0491/1258/0262/files/basket.jpg?v=1744290417"}
  ];

  const CART = {};

  function renderProducts(){
    const prodDiv = document.getElementById("productList");
    prodDiv.innerHTML = "<strong>المنتجات</strong>";
    PRODUCTS.forEach(p=>{
      const div = document.createElement("div");
      div.className = "product";
      div.innerHTML = `
        <div style="display:flex;align-items:center;">
          <img src="${p.image}" alt="">
          <div>
            <div>${p.name}</div>
            <small>${p.sku}</small>
          </div>
        </div>
        <button onclick="addToCart('${p.sku}')">+</button>`;
      prodDiv.appendChild(div);
    });
  }

  function renderCart(){
    const cartDiv = document.getElementById("cartList");
    cartDiv.innerHTML = "<strong>السلة</strong>";
    Object.keys(CART).forEach(sku=>{
      const item = PRODUCTS.find(p=>p.sku===sku);
      const qty = CART[sku];
      const div = document.createElement("div");
      div.className = "product";
      div.innerHTML = `
        <div>${item.name} (${sku})</div>
        <input class="qty" type="number" min="1" value="${qty}" onchange="updateQty('${sku}', this.value)">
        <button onclick="removeFromCart('${sku}')">×</button>`;
      cartDiv.appendChild(div);
    });
  }

  function addToCart(sku){
    CART[sku] = (CART[sku]||0)+1;
    renderCart();
  }

  function updateQty(sku, val){
    const q = parseInt(val);
    if(q > 0) CART[sku] = q;
    else delete CART[sku];
    renderCart();
  }

  function removeFromCart(sku){
    delete CART[sku];
    renderCart();
  }

  function buildCSV(){
    const rows = ["SKU,Quantity"];
    Object.entries(CART).forEach(([sku, qty]) => rows.push(`${sku},${qty}`));
    return rows.join("\n");
  }

  function submitOrder(){
    const from = document.getElementById("fromBranch").value;
    const to = document.getElementById("toBranch").value;
    if(!from || !to){ alert("يجب اختيار الفرعين (من/إلى)."); return; }
    if(!Object.keys(CART).length){ alert("السلة فارغة."); return; }
    const csv = buildCSV();

    fetch(webhookURL, {
      method: "POST",
      headers: { "Content-Type":"application/json" },
      body: JSON.stringify({ fromBranch: from, toBranch: to, csv })
    })
    .then(res => res.text())
    .then(_ => alert("تم إرسال الطلب إلى Zapier بنجاح."))
    .catch(_ => alert("خطأ أثناء الإرسال إلى Zapier."));
  }

  renderProducts();
</script>
</body>
</html>
